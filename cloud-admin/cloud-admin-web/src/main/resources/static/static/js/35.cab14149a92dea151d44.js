webpackJsonp([35],{eVRh:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("woOf"),s=n.n(a),o=n("Xxa5"),r=n.n(o),i=n("exGp"),u=n.n(i),l=n("Dd8w"),c=n.n(l),d=n("p+m2"),m=n("oDnd"),f=n("YMRc"),p=n("M4fF"),h=n.n(p),v=n("t5DY"),b=n("NYxO"),w={name:"Menu",components:{VTreeTable:d.a,TreeColumn:m.a},data:function(){return{searchForm:{menuName:""},showSearch:!1,tableData:[],menuModuleLabel:"系统管理",menuModuleValue:"jeeadmin",menuModuleList:[]}},computed:c()({},Object(b.b)(["propData"])),created:function(){var e=this;return u()(r.a.mark(function t(){var n,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.$route.query.menuModuleValue,t.next=3,e.getDictsData();case 3:n&&(a=e.menuModuleList.filter(function(e){return e.dictValue===n})).length>0&&(e.menuModuleLabel=a[0].dictLabel,e.menuModuleValue=n),e.findMenuList();case 5:case"end":return t.stop()}},t,e)}))()},activated:function(){this.propData&&(this.propData.isEdit?this.updateRow(this.propData.data):this.insertRow(this.propData.data),this.$store.commit("DEL_PROP_DATA"))},methods:{changeMenuModule:function(e,t){this.menuModuleLabel===e&&this.menuModuleValue===t||(this.menuModuleLabel=e,this.menuModuleValue=t,this.tableData=[],this.findMenuList())},getDictsData:function(){var e=this;return u()(r.a.mark(function t(){var n;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(v.b)("sys_menu_sys_code");case 2:"0000"===(n=t.sent).code&&(e.menuModuleList=n.data);case 4:case"end":return t.stop()}},t,e)}))()},findMenuList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.menuModuleValue;return u()(r.a.mark(function a(){var s;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(f.q)({menuUuid:t,sysCode:n});case 2:"0000"===(s=a.sent).code&&(e.tableData=e.tableData.concat(s.data));case 4:case"end":return a.stop()}},a,e)}))()},queryMenuList:function(){var e=this;return u()(r.a.mark(function t(){var n,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=s()({},e.searchForm,{sysCode:e.menuModuleValue}),t.next=3,Object(f.A)(n);case 3:"0000"===(a=t.sent).code&&a.data.forEach(function(t){e.tableData.push(t)});case 5:case"end":return t.stop()}},t,e)}))()},search:function(){this.tableData=[],this.searchForm.menuName?this.queryMenuList():this.findMenuList()},reset:function(){this.searchForm.menuName="",this.tableData=[],this.findMenuList()},expend:function(e,t){t.length||this.findMenuList(e.uuid)},expendAll:function(){this.$refs.treeTable.expendNode()},closeAll:function(){this.$refs.treeTable.closeNode()},sort:function(e){h.a.find(this.tableData,function(t){return t.uuid===e.uuid}).menuSort=e.menuSort},saveSort:function(){var e=this;return u()(r.a.mark(function t(){var n;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.tableData.map(function(e){return{menuUuid:e.uuid,menuSort:e.menuSort}}),t.next=3,Object(f.D)(n);case 3:"0000"===t.sent.code&&(e.$message({type:"success",message:"操作成功"}),e.tableData=[],e.findMenuList());case 5:case"end":return t.stop()}},t,e)}))()},goAdd:function(){this.$router.push({name:"MenuAdd",query:{sysCode:this.menuModuleValue}})},goEdit:function(e){this.$router.push({name:"MenuEdit",query:{uuid:e.uuid,sysCode:this.menuModuleValue}})},goAddChild:function(e){this.$router.push({name:"MenuAdd",query:{sysCode:this.menuModuleValue,parentUuid:e.uuid}})},del:function(e){var t=this;this.$confirm("确认要删除该菜单及所有子菜单吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(u()(r.a.mark(function n(){var a;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(f.k)({menuUuid:e.uuid});case 2:"0000"===n.sent.code&&(t.$message({type:"success",message:"删除成功!"}),a=h.a.findIndex(t.tableData,function(t){return e.uuid===t.uuid}),t.tableData.splice(a,1));case 4:case"end":return n.stop()}},n,t)})))},updateRow:function(e){var t=this,n=h.a.findIndex(this.tableData,function(t){return e.uuid===t.uuid});this.tableData.splice(n,1,e),this.$nextTick(function(){t.$refs.treeTable.setCurrentRow(e)})},insertRow:function(e){var t=this,n=h.a.findIndex(this.tableData,function(t){return e.parentUuid===t.uuid});if(n>-1){this.tableData[n].isLeaf=!1;var a=h.a.cloneDeep(this.tableData[n]);this.tableData.splice(n+1,0,e),this.$nextTick(function(){t.$refs.treeTable.toggleRowExpand(a),t.$refs.treeTable.setCurrentRow(e)})}else this.tableData.push(e)}}},_={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"jee-page"},[n("div",{staticClass:"jee-header"},[n("div",{staticClass:"jee-title"},[n("i",{class:e.$route.meta.icon}),e._v("\n      "+e._s(e.$route.meta.title)+"\n      "),n("el-dropdown",{staticClass:"dropdown-menu",attrs:{trigger:"click"}},[n("span",{staticClass:"el-dropdown-link"},[e._v("\n          "+e._s(e.menuModuleLabel)),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.menuModuleList,function(t,a){return n("el-dropdown-item",{key:a,nativeOn:{click:function(n){e.changeMenuModule(t.dictLabel,t.dictValue)}}},[e._v(e._s(t.dictLabel)+"\n          ")])}))],1)],1),e._v(" "),n("div",{staticClass:"jee-tools"},[n("el-button",{attrs:{icon:"fa fa-filter",size:"small"},on:{click:function(t){e.showSearch=!e.showSearch}}},[e._v(" "+e._s(e.showSearch?"隐藏":"查询")+"\n      ")]),e._v(" "),n("el-button",{attrs:{icon:"fa fa-angle-double-down",size:"small"},on:{click:e.expendAll}},[e._v(" 展开")]),e._v(" "),n("el-button",{attrs:{icon:"fa fa-angle-double-up",size:"small"},on:{click:e.closeAll}},[e._v(" 折叠")]),e._v(" "),e.$permission["sys:menu:add"]?n("el-button",{attrs:{icon:"fa fa-plus",size:"small"},on:{click:e.goAdd}},[e._v(" 新增")]):e._e(),e._v(" "),e.$permission["sys:menu:sort"]?n("el-button",{attrs:{icon:"fa fa-sort-amount-asc",size:"small"},on:{click:e.saveSort}},[e._v(" 保存排序\n      ")]):e._e()],1)]),e._v(" "),n("div",{staticClass:"jee-body"},[e.showSearch?n("el-form",{ref:"form",staticClass:"jee-search-form",attrs:{model:e.searchForm,inline:""}},[n("el-form-item",{attrs:{label:"菜单名称:"}},[n("el-input",{attrs:{placeholder:"请填写",size:"small"},model:{value:e.searchForm.menuName,callback:function(t){e.$set(e.searchForm,"menuName",t)},expression:"searchForm.menuName"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.search}},[e._v("查询")]),e._v(" "),n("el-button",{attrs:{size:"small"},on:{click:e.reset}},[e._v("重置")])],1)],1):e._e(),e._v(" "),n("div",{directives:[{name:"auto-height",rawName:"v-auto-height"}],staticClass:"jee-table-box"},[n("v-tree-table",{ref:"treeTable",attrs:{data:e.tableData,"highlight-current-row":"","sort-key":"menuSort",border:""},on:{expend:e.expend}},[n("tree-column",{attrs:{label:"菜单名称","header-align":"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("i",{class:"fa-fw "+t.row.menuIcon}),e._v(" "),n("el-button",{attrs:{type:"text"},on:{click:function(n){e.goEdit(t.row)}}},[e._v(e._s(t.row.menuName))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"链接",prop:"menuHref","header-align":"center","show-overflow-tooltip":""}}),e._v(" "),n("el-table-column",{attrs:{label:"排序",prop:"menuSort",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{attrs:{size:"mini"},on:{change:function(n){e.sort(t.row)}},model:{value:t.row.menuSort,callback:function(n){e.$set(t.row,"menuSort",n)},expression:"scope.row.menuSort"}})]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"类型",prop:"menuType",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["0"===t.row.menuType?n("el-tag",{attrs:{size:"mini"}},[e._v("目录")]):"1"===t.row.menuType?n("el-tag",{attrs:{type:"success",size:"mini"}},[e._v("菜单")]):"2"===t.row.menuType?n("el-tag",{attrs:{type:"info",size:"mini"}},[e._v("权限")]):e._e()]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"可见",prop:"showFlag",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["0"===t.row.showFlag?n("span",{staticStyle:{color:"#999"}},[e._v("隐藏")]):"1"===t.row.showFlag?n("span",[e._v("显示")]):e._e()]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"权限标识",prop:"permission","header-align":"center","show-overflow-tooltip":""}}),e._v(" "),n("el-table-column",{attrs:{label:"权重",prop:"menuWeightName",align:"center","show-overflow-tooltip":""}}),e._v(" "),n("el-table-column",{attrs:{label:"操作",width:"149",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.$permission["sys:menu:edit"]?n("el-button",{attrs:{type:"success-text",title:"编辑菜单",icon:"fa fa-pencil"},on:{click:function(n){e.goEdit(t.row)}}}):e._e(),e._v(" "),e.$permission["sys:menu:delete"]?n("el-button",{attrs:{title:"删除菜单",type:"danger-text",icon:"fa fa-trash-o"},on:{click:function(n){e.del(t.row)}}}):e._e(),e._v(" "),e.$permission["sys:menu:add"]?n("el-button",{attrs:{title:"新增下级菜单",type:"primary-text",icon:"fa fa-plus-square"},on:{click:function(n){e.goAddChild(t.row)}}}):e._e()]}}])})],1)],1)],1)])},staticRenderFns:[]};var g=n("VU/8")(w,_,!1,function(e){n("kl5J")},"data-v-78431595",null);t.default=g.exports},kl5J:function(e,t){}});