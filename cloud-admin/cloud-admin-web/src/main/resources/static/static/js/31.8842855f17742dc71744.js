webpackJsonp([31],{bX6v:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("//Fk"),n=a.n(r),o=a("Xxa5"),s=a.n(o),l=a("exGp"),i=a.n(l),c=a("p+m2"),u=a("oDnd"),d=a("V/8j"),f={name:"Area",components:{VTreeTable:c.a,treeColumn:u.a},data:function(){return{searchForm:{areaCode:"",areaName:""},showSearch:!0,tableData:[]}},mounted:function(){this.findAreaList()},methods:{search:function(){this.tableData=[],this.searchForm.areaCode||this.searchForm.areaName||this.searchForm.areaStatus?this.queryAreaList():this.findAreaList()},queryAreaList:function(){var e=this;return i()(s.a.mark(function t(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(d.x)(e.searchForm);case 2:"0000"===(a=t.sent).code&&(e.tableData=a.data);case 4:case"end":return t.stop()}},t,e)}))()},reset:function(){this.searchForm={areaCode:"",areaName:""},this.tableData=[],this.findAreaList()},expend:function(e,t){t.length||this.findAreaList(e.uuid)},findAreaList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0",a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return i()(s.a.mark(function r(){var n;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(d.p)({areaUuid:t});case 2:if("0000"!==(n=r.sent).code){r.next=9;break}if(a){r.next=8;break}e.tableData=e.tableData.concat(n.data),r.next=9;break;case 8:return r.abrupt("return",n.data);case 9:case"end":return r.stop()}},r,e)}))()},goAdd:function(){this.$router.push({name:"AreaAdd"})},goEdit:function(e){this.$router.push({name:"AreaEdit",query:{uuid:e.uuid}})},goAddChild:function(e){this.$router.push({name:"AreaAdd",params:{parentUuid:e.uuid}})},changeStatus:function(e){var t=this,a={uuid:e.uuid,areaStatus:"0"===e.areaStatus?"2":"0"},r="0"===e.areaStatus?"确认要停用该区域吗？":"确认要启用该区域吗";this.$confirm(r,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(i()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.e)(a);case 2:"0000"===e.sent.code&&(t.$message({type:"success",message:"操作成功!"}),t.tableData=[],t.findAreaList());case 4:case"end":return e.stop()}},e,t)})))},del:function(e){var t=this;this.$confirm("确认要删除该区域及所有子区域吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(i()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(d.h)({areaUuid:e.uuid});case 2:"0000"===a.sent.code&&(t.$message({type:"success",message:"删除成功!"}),t.tableData=[],t.findAreaList());case 4:case"end":return a.stop()}},a,t)})))},expendAll:function(){var e=this;return i()(s.a.mark(function t(){var a,r,o,l,i,c;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(a=e.$refs.treeTable.getWaitLoadNode(),r=[],o=(new Date).getTime(),l=0;l<a.length;l++)r.push(e.findAreaList(a[l],!0));return t.next=6,n.a.all(r);case 6:i=t.sent,console.log(((new Date).getTime()-o)/1e3+"s","ajax-timer"),c=[],i.forEach(function(e){c=c.concat(e)}),c.length&&(e.tableData=e.tableData.concat(c)),e.$nextTick(function(){e.$refs.treeTable.expendNode()});case 12:case"end":return t.stop()}},t,e)}))()},closeAll:function(){this.$refs.treeTable.closeNode()}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"jee-page"},[a("div",{staticClass:"jee-header"},[a("div",{staticClass:"jee-title"},[a("i",{class:e.$route.meta.icon}),e._v(" "+e._s(e.$route.meta.title))]),e._v(" "),a("div",{staticClass:"jee-tools"},[a("el-button",{attrs:{icon:"fa fa-filter",size:"small"},on:{click:function(t){e.showSearch=!e.showSearch}}},[e._v(" "+e._s(e.showSearch?"隐藏":"查询")+"\n      ")]),e._v(" "),a("el-button",{attrs:{icon:"fa fa-angle-double-down",size:"small"},on:{click:e.expendAll}},[e._v(" 展开")]),e._v(" "),a("el-button",{attrs:{icon:"fa fa-angle-double-up",size:"small"},on:{click:e.closeAll}},[e._v(" 折叠")]),e._v(" "),e.$permission["sys:area:add"]?a("el-button",{attrs:{icon:"fa fa-plus",size:"small"},on:{click:e.goAdd}},[e._v(" 新增")]):e._e()],1)]),e._v(" "),a("div",{staticClass:"jee-body"},[e.showSearch?a("el-form",{ref:"form",staticClass:"jee-search-form",attrs:{model:e.searchForm,inline:""}},[a("el-form-item",{attrs:{label:"区域代码："}},[a("el-input",{attrs:{placeholder:"请填写",size:"small"},model:{value:e.searchForm.areaCode,callback:function(t){e.$set(e.searchForm,"areaCode",t)},expression:"searchForm.areaCode"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"区域名称："}},[a("el-input",{attrs:{placeholder:"请填写",size:"small"},model:{value:e.searchForm.areaName,callback:function(t){e.$set(e.searchForm,"areaName",t)},expression:"searchForm.areaName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态："}},[a("el-select",{attrs:{size:"small"},model:{value:e.searchForm.areaStatus,callback:function(t){e.$set(e.searchForm,"areaStatus",t)},expression:"searchForm.areaStatus"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),a("el-option",{attrs:{label:"正常",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"停用",value:"2"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.search}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.reset}},[e._v("重置")])],1)],1):e._e(),e._v(" "),a("div",{directives:[{name:"auto-height",rawName:"v-auto-height"}],staticClass:"jee-table-box"},[a("v-tree-table",{ref:"treeTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"sort-key":"areaSort",border:"",height:"100%"},on:{expend:e.expend}},[a("tree-column",{attrs:{label:"区域名称","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            ( "+e._s(t.row.areaCode)+" )\n            "),a("el-button",{attrs:{type:"text"},on:{click:function(a){e.goEdit(t.row)}}},[e._v(e._s(t.row.areaName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"areaShortName",align:"center",label:"区域简称","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"areaTypeName",align:"center",label:"区域类型","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"remarks","header-align":"center",label:"备注信息","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"areaSort",align:"center",label:"排序号","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"状态",width:"92","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return["0"===t.row.areaStatus?a("el-tag",{attrs:{type:"success",size:"mini"}},[e._v("正常")]):"2"===t.row.areaStatus?a("el-tag",{attrs:{type:"danger",size:"mini"}},[e._v("停用")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"149",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{"open-delay":400,effect:"light",content:"编辑区域",placement:"bottom-start"}},[a("el-button",{attrs:{type:"success-text",icon:"fa fa-pencil"},on:{click:function(a){e.goEdit(t.row)}}})],1),e._v(" "),"0"===t.row.areaStatus?a("el-tooltip",{attrs:{"open-delay":400,effect:"light",content:"停用区域",placement:"bottom-start"}},[e.$permission["sys:area:status"]?a("el-button",{attrs:{type:"danger-text",icon:"fa fa-ban"},on:{click:function(a){e.changeStatus(t.row)}}}):e._e()],1):e._e(),e._v(" "),"2"===t.row.areaStatus?a("el-tooltip",{attrs:{"open-delay":400,effect:"light",content:"启用区域",placement:"bottom-start"}},[e.$permission["sys:area:status"]?a("el-button",{attrs:{type:"primary-text",icon:"fa fa-play"},on:{click:function(a){e.changeStatus(t.row)}}}):e._e()],1):e._e(),e._v(" "),a("el-tooltip",{attrs:{"open-delay":400,effect:"light",content:"删除区域",placement:"bottom-start"}},[e.$permission["sys:area:delete"]?a("el-button",{attrs:{type:"danger-text",icon:"fa fa-trash-o"},on:{click:function(a){e.del(t.row)}}}):e._e()],1),e._v(" "),a("el-tooltip",{attrs:{"open-delay":400,effect:"light",content:"新增下级区域",placement:"bottom-start"}},[e.$permission["sys:area:add"]?a("el-button",{attrs:{type:"primary-text",icon:"fa fa-plus-square"},on:{click:function(a){e.goAddChild(t.row)}}}):e._e()],1)]}}])})],1)],1)],1)])},staticRenderFns:[]};var p=a("VU/8")(f,m,!1,function(e){a("lsPP")},"data-v-f7a35dd2",null);t.default=p.exports},lsPP:function(e,t){}});